<!doctype html><html lang="es"><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>Ajustes</title><link rel="stylesheet" href="css/style.css"/></head><body><div id="navbar"></div><main class="container"><div class="card"><h2>Ajustes de cuenta</h2><div class="grid grid-2"><div><h3>Perfil</h3><form id="user-settings-form"><label>Nombre <input class="input" name="name" required/></label><label>Email <input class="input" name="email" type="email" required/></label><label>Bio <textarea class="input" name="bio" rows="4"></textarea></label><div style="margin-top:.6rem"><button class="btn" type="submit">Guardar perfil</button></div></form></div><div><h3>Cambiar contraseña</h3><form id="change-password-form"><label>Contraseña actual <input class="input" name="current" type="password" required/></label><label>Nueva contraseña <input class="input" name="newpass" type="password" required/></label><div style="margin-top:.6rem"><button class="btn" type="submit">Cambiar contraseña</button></div></form><div id="settings-msg" class="small" style="margin-top:.6rem"></div></div></div></div></main><footer class="footer">Ajustes — Demo</footer><script>function requireUser(){ const u = (localStorage.getItem('demo_user_v1')?JSON.parse(localStorage.getItem('demo_user_v1')):null); if(!u){ location.href='signin.html?returnTo='+encodeURIComponent(location.pathname); return false; } return u; }document.addEventListener('DOMContentLoaded', ()=>{ const user = requireUser(); if(!user) return; const users = JSON.parse(localStorage.getItem('demo_users_v3')||'[]'); const full = users.find(x=>x.email===user.email); const f = document.getElementById('user-settings-form'); f.elements['name'].value = full.name || ''; f.elements['email'].value = full.email || ''; f.elements['bio'].value = full.bio || ''; f.addEventListener('submit', (e)=>{ e.preventDefault(); const name = f.elements['name'].value.trim(); const email = f.elements['email'].value.trim(); const bio = f.elements['bio'].value.trim(); const idx = users.findIndex(x=>x.email===user.email); if(idx>-1){ users[idx].name = name; users[idx].email = email; users[idx].bio = bio; localStorage.setItem('demo_users_v3', JSON.stringify(users)); const publicUser = { id: users[idx].id, name: users[idx].name, email: users[idx].email, role: users[idx].role }; localStorage.setItem('demo_user_v1', JSON.stringify(publicUser)); showAlert('Perfil actualizado', 'success'); renderNavbar(); } }); const cp = document.getElementById('change-password-form'); cp.addEventListener('submit', (e)=>{ e.preventDefault(); const current = cp.elements['current'].value; const novo = cp.elements['newpass'].value; const idx = users.findIndex(x=>x.email===user.email); if(idx===-1){ showAlert('Usuario no encontrado','danger'); return; } if(users[idx].password !== current){ showAlert('Contraseña actual incorrecta','danger'); return; } users[idx].password = novo; localStorage.setItem('demo_users_v3', JSON.stringify(users)); showAlert('Contraseña actualizada','success'); cp.reset(); }); });</script><script src="js/nav.js"></script><script src="js/app.js"></script></body></html>