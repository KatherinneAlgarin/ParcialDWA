<h4 *ngIf="usuario">Hola, {{ usuario.nombre }}</h4>

<div class="row my-4 g-4">
  <div class="col-md-4">
    <div class="card stats-card h-100">
      <div class="card-body text-center d-flex flex-column justify-content-center">
        <h3 classs="fw-bold">
          {{ aplicaciones.length || 0 }}
        </h3>
        <p class="text-muted mb-1">Trabajos aplicados</p>
        <i class="bi bi-briefcase fs-3 text-primary"></i>
      </div>
    </div>
  </div>
  </div>

<div class="card shadow-sm">
  <div class="card-header bg-white">
    <strong>Aplicaciones recientes</strong>
  </div>
  <div class="table-responsive">
    <table class="table align-middle mb-0">
      <thead class="table-light">
        <tr>
          <th>Trabajo</th>
          <th>Fecha de aplicación</th>
          <th>Estado</th>
          <th>Acciones</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngIf="isLoading">
          <td colspan="4" class="text-center p-5">
            <div class="spinner-border text-primary" role="status">
              <span class="visually-hidden">Cargando...</span>
            </div>
          </td>
        </tr>

        <tr *ngIf="!isLoading && errorMessage">
          <td colspan="4" class="text-center text-danger p-4">
            {{ errorMessage }}
          </td>
        </tr>

        <tr *ngIf="!isLoading && !errorMessage && aplicaciones.length === 0">
          <td colspan="4" class="text-center text-muted p-4">
            Aún no has aplicado a ningún trabajo. 
            <a routerLink="/candidato/empleos">¡Encuentra tu próxima oportunidad!</a>
          </td>
        </tr>

        <tr *ngFor="let app of aplicaciones.slice(0, 5)">
          <td>
            <div class="fw-bold">{{ app.Oferta?.titulo || 'N/A' }}</div>
            <small class="text-muted">{{ app.Oferta?.Empresa?.nombre || 'N/A' }}</small>
          </td>
          <td>{{ formatearFecha(app.fecha_aplicacion) }}</td>
          <td>
            <span class="badge" [ngClass]="getStatusInfo(app.estado).clase">
              {{ getStatusInfo(app.estado).texto }}
            </span>
          </td>
          <td>
            <a [routerLink]="['/candidato/oferta', app.Oferta?.idoferta]" class="btn btn-outline-primary btn-sm">
              Ver Oferta
            </a>
          </td>
        </tr>

      </tbody>
    </table>
  </div>
</div>